<!-- ****************************************************************** -->
<!-- Librairie Technique                                                -->
<!-- Auteurs :                                                          -->
<!-- Marin Dacos. 2002.                                                 -->
<!-- Nicolas Nutten. 2003.                                              -->
<!-- ****************************************************************** -->

<DEFMACRO NAME="OUVRIR_HTML">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Ouvre la page HTML                                                 -->
<!-- ****************************************************************** -->
	<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
	<html>
	<head>
</DEFMACRO> 

<DEFMACRO NAME="FERMER_HTML">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Ferme la page HTML                                                 -->
<!-- ****************************************************************** -->
	</body>
	</html>
</DEFMACRO>

<DEFMACRO NAME="DEFINIR_CHARSET">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Permet de déclarer le charset (jeux de caractères, dépendant de la -->
<!-- langue principale utilisée).                                       -->
<!-- Macro à appeler dans l'entête du fichier HTML (entre les balises   -->
<!-- <HEAD> et </HEAD> ou entre les macros OUVRIR_HTML et INSERER_STYLE)-->
<!-- ****************************************************************** -->
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</DEFMACRO>

<DEFMACRO NAME="INSERER_STYLE">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Permet d'appeler la feuille de style CSS de la revue, de fermer    -->
<!-- l'en-tête de la page HTML puis d'ouvrir le corps de la page et     -->
<!-- d'afficher le tableau de bord (desk) au sommet de la page pour les -->
<!-- utilisateurs logués en tant qu'admin, éditeur, rédacteurs, etc ... -->
<!-- ****************************************************************** -->
	<link rel="stylesheet" href="styles_revue.css">
	</head>
	<body> 
	<IF [#VISITEUR]>
		<? insert_template("desk");?>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="ACTIVER_INDEXATION">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Autorise l'indexation par les moteurs de recherche.                -->
<!-- Macro à appeller dans l'en-tête du fichier HTML (entre les balises -->
<!-- <HEAD> et </HEAD> ou entre les macros OUVRIR_HTML et INSERER_STYLE)-->
<!-- ****************************************************************** -->
	<meta name="ROBOTS" content="follow, index">
</DEFMACRO>

<DEFMACRO NAME="DESACTIVER_INDEXATION">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Interdit l'indexation de la page par les moteurs.                  -->
<!-- Très utile pour éviter les redondances des divers formats de pages.-->
<!-- Pages à exclure : format d'impression, signalement par courriel,   -->
<!-- etc...   Evitons de faire du bruit sur les moteurs, et le web en   -->
<!-- sortira clarifié.                                                  -->
<!-- Macro à appeller dans l'entête du fichier HTML (entre les balises  -->
<!-- <HEAD> et </HEAD> ou entre les macros OUVRIR_HTML et INSERER_STYLE)-->
<!-- ****************************************************************** -->
	<meta name="ROBOTS" content="follow, noindex">
</DEFMACRO>

<DEFMACRO NAME="FORMULAIRE_RECHERCHE">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Formulaire permettant d'effectuer une recherche.                   -->
<!-- ****************************************************************** -->
	<form action="/cgi-bin/esearch/esearch.pl" method="get">
		<b>Chercher</b><br />
		<input type="text" size="17" name="search" value="votre recherche" 
			onfocus="if(this.value=='votre recherche')this.value='';" />
		<input type=hidden name="url_back" value="http://[#REVUE].revues.org/">
		<input type=hidden name="[#REVUE]" value="CHECKED" checked [#REVUE]>
		<input type=hidden name="addsite" value="Chercher">
		<input type="image" border="0" name="imageField" src="images/ok.gif" width="20" height="9">
	</form>
</DEFMACRO>

<DEFMACRO NAME="IN_EXTENSO">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Appel du moteur de recherche In-extenso                            -->
<!-- ****************************************************************** -->
	<form name="In-extenso" method="get" action="http://www.in-extenso.org/search">
		<table width="98%" border="0" cellspacing="0" cellpadding="2" align="center">
			<tr>
				<td class="texte_petit_centre" background="commun/images/bleu.gif">
					<span class="texte_trespetit_centre">
					<input type="hidden" name="aspsk" value="true" checked>
					<input type="hidden" name="qrls" value="true" checked>
					<input type="hidden" name="all" value="true" checked>
					<input type="hidden" name="ps" value="7">
					<input type="text" size="17" name="q" value="votre recherche" onfocus="if(this.value=='votre recherche')this.value='';" />
					<input type=hidden name="bck" value="http://[#REVUE].revues.org/">
					<br />
					<input type="submit" name="Submit" value="Chercher">
					<input type="hidden" name="rev" value="[#REVUE]" checked>
					</span>
					<br />
				</td>
			</tr>
		</table>
	</form>
</DEFMACRO>

<DEFMACRO NAME="MENU_THEMES_PUBLIES">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Menu déroulant affichant la liste des publications de type thème,  -->
<!-- qui sont publiés.                                                  -->
<!-- ****************************************************************** -->
	<form name="pub_menu_B">
		<select name="menu_types" onChange="MM_jumpMenu('parent',this,0)">
		<option value="index.html">Thèmes</option>
		<BOUCLE NAME="pub_menu_B" TABLE="publications" WHERE="ok" WHERE="type='theme'" ORDER="ordre DESC">
			<CORPS>	
				<option value="sommaire.html?id=[#ID]">
					[#NOM]
				</option>
			</CORPS>
		</BOUCLE>
		</select>
	</form>
</DEFMACRO>

<DEFMACRO NAME="DATE_PUBLICATION_PARENTE_POUR_META">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Affiche la date de publication parente d'un document, si elle      -->
<!-- existe sinon affiche "0000-00-00".                                 -->
<!-- Cette macro est destinée à l'affichage des métadonnées.            -->
<!-- ****************************************************************** -->
	<BOUCLE TABLE="publications" WHERE="id='[#PUBLICATION]'">
		<CORPS>
			<IF [#TYPE]=="regroupement">
			<!-- Si on est dans un regroupement on remonte au niveau du parent du regroupement -->
	            <BOUCLE TABLE="publications" WHERE="id='[#PARENT]'">
					<CORPS>
						<IF [#DATE]!="0000-00-00">
							<meta name="DC.Date" content="[#DATE]">
						</IF>
					</CORPS>
				</BOUCLE>
			<ELSE/>
				<IF [#DATE]!="0000-00-00">
					<meta name="DC.Date" content="[#DATE]">
				</IF>
			</IF>
		</CORPS>
	</BOUCLE>
</DEFMACRO>

<DEFMACRO NAME="METADONNEES">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Affichage des métadonnées HTML et DUBLIN CORE.                     -->
<!-- Ceci est fondamental pour la sémantisation du WEB et la qualité de -->
<!-- l'indexation par les moteurs. Pensez à personnaliser ces           -->
<!-- métadonnées en indiquant le nom de votre publication, son url, son -->
<!-- éditeur, etc...                                                    -->
<!-- ****************************************************************** -->
	<meta name="GENERATOR" content="Lodel 2002, maquettes par Marin Dacos">
	<meta name="DESCRIPTION" content="Ruralia, revue de sciences humaines étudiant le monde rural dans toutes ses dimensions, adhère à la fédération www.revues.org">
	<meta name="distribution" content="worldwide">
	<meta name="REVISIT-AFTER" content="40 days">
	<meta name="rating" content="General">
	
	<meta url="http://ruralia.revues.org/document.html?id=[#ID]">
	
	<BOUCLE NAME="meta_auteurs" TABLE="auteurs" WHERE="iddocument='[#ID]'" ORDER="ordre">
		<meta name="author" content="[#PRENOM] [#NOMFAMILLE]">
	</BOUCLE>
	
	<BOUCLE NAME="meta_motscles_lineaires" TABLE="indexls" WHERE="iddocument='[#ID]'" ORDER="ordre">
		<meta name="KEYWORDS" content="[#MOT]">
	</BOUCLE>
	
	<!-- METADONNEES DUBLIN CORE -->
	
	<meta name="DC.Publisher" content="Association des ruralistes français">
	<meta name="DC.Source" content="http://ruralia.revues.org/">
	
	<meta name="DC.Type" content="text">
	<meta name="DC.Format" content="text/html">
	
	<meta name="DC.Language" content="fr">
	<meta name="DC.Rights" content="IPR">
	<meta name="DC.Relation" content="http://www.revues.org">
	
	<meta name="DC.Identifier" content="http://ruralia.revues.org/document.html?id=[#ID]">
	<meta name="DC.Title" content="[(#TITRE|textebrut)] [(#SOUSTITRE|textebrut)]">

	<BOUCLE NAME="meta_dc_motscles_l" TABLE="indexls" WHERE="iddocument='[#ID]'" ORDER="ordre">
		<meta name="DC.Subject" content="[#MOT]">
	</BOUCLE>
	
	<BOUCLE NAME="meta_dc_motscles_h" TABLE="indexhs" WHERE="iddocument='[#ID]'" ORDER="ordre">
		<meta name="DC.Subject" content="[#MOT]">
	</BOUCLE>
	
	<BOUCLE NAME="meta_dc_auteurs" TABLE="auteurs"  WHERE="iddocument='[#ID]'" ORDER="ordre">
		<meta name="DC.Creator" content="[#PRENOM] [#NOMFAMILLE]">
	</BOUCLE>
	
	<MACRO NAME="DATE_PUBLICATION_PARENTE_POUR_META">
	
	<IF [#RESUME:FR]>
		<meta name="DC.Description" lang="fr" content="[(#RESUME:FR|textebrut)]">
	<ELSE/>
		<!-- Ici, j'utilise une astuce : si pas de résumé, je cherche à faire passer-->
		<!-- comme résumé les 1500 premiers caractères du texte ou du texte d'intro-->
		<meta name="DC.Description" lang="fr" content="[(#TEXTE|textebrut|couper(1500))]">
	</IF>
	<meta name="DC.Description" lang="en" content="[(#RESUME:EN|textebrut)]">
</DEFMACRO>

<DEFMACRO NAME="METADONNEES_POUR_INDEX">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Affichage des métadonnées HTML et DUBLIN CORE pour les index.      -->
<!-- Pensez à personnaliser ces métadonnées.                            -->
<!-- ****************************************************************** -->
	<!-- METADONNEES HTML -->
	<meta name="GENERATOR" content="Lodel 2002">
	<meta name="DESCRIPTION" content="<MACRO NAME="DESCRIPTION_REVUE">">
	<meta HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1">
	<meta URL="http://test.revues.org">
	<meta name="distribution" content="worldwide">
	<meta name="REVISIT-AFTER" content="24 days">
	<meta name="rating" content="General">
	
	<!-- METADONNEES DUBLIN CORE -->
	<IF [#TITRE]>
		<meta name="DC.Title" content="[(#TITRE|textebrut)] [(#SOUSTITRE|textebrut)]">
	<ELSE/>
		<meta name="DC.Title" content="<MACRO NAME="DESCRIPTION_REVUE">">
	</IF>
	
	<meta name="DC.Type" content="text">
	<meta name="DC.Format" content="text/html">
	<meta name="DC.Identifier" content="http://test.revues.org">
	<meta name="DC.Source" content="http://test.revues.org/">
	<meta name="DC.Language" content="fr">
	<meta name="DC.Relation" content="http://www.revues.org">
	<meta name="DC.Coverage" content="?">
	<meta name="DC.Rights" content="IPR">
	
	<IF [#RESUME:FR]>
		<meta NAME="DC.Description" lang="fr" content="[(#RESUME:FR|textebrut)]">
	<ELSE/>
		<!-- Ici, j'utilise une astuce : si pas de résumé, je cherche à faire passer-->
		<!-- comme résumé les 1500 premiers caractères du texte ou du texte d'intro-->
		<meta name="DC.Description" lang="fr" content="[(#TEXTE|textebrut|couper(1500))]">
	</IF>
	
	<meta name="DC.Description" lang="en" content="[(#RESUME:EN|textebrut)]">
	<meta name="DC.Publisher" content="INSEREZ ICI LE NOM DE VOTRE EDITEUR">
</DEFMACRO>

<DEFMACRO NAME="JS_JUMPMENU">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Fonction javascript destinée à faire des listes déroulantes menant -->
<!-- à une URL.                                                         -->
<!-- ****************************************************************** -->
	<script language="JavaScript">
	<!--
	function MM_jumpMenu(targ,selObj,restore){ //v3.0
	  eval(targ+".location='"+selObj.options[selObj.selectedIndex].value+"'");
	  if (restore) selObj.selectedIndex=0;
	}
	//-->
	</script>
</DEFMACRO>

<DEFMACRO NAME="JS_CHANGE_IMAGE">
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Fonction javascript permettant de changer une image survolée par   -->
<!-- la souris.                                                         -->
<!-- ****************************************************************** -->
<script language="JavaScript">
	<!--
	function MM_swapImgRestore() { //v3.0
	  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
	}
	
	function MM_preloadImages() { //v3.0
	  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
	    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
	    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
	}
	
	function MM_findObj(n, d) { //v4.0
	  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
	    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
	  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
	  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
	  if(!x && document.getElementById) x=document.getElementById(n); return x;
	}
	
	function MM_swapImage() { //v3.0
	  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
	   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
	}
	//-->
</script>
</DEFMACRO>

<DEFMACRO NAME="JS_OUVRE_FENETRE"> 
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Fonction javascript d'ouverture de fenêtre volante.                -->
<!-- ****************************************************************** -->
<script language="JavaScript"> 
	<!-- MM_openBrWindow
		function MM_openBrWindow(theURL,winName,features) { //v2.0 
		window.open(theURL,winName,features); 
		} 
	//--> 
</script> 
</DEFMACRO>

<DEFMACRO NAME="JS_BOUTON_PAGE_PRECEDENTE"> 
<!-- ****************************************************************** -->
<!-- Version 1.0                                                        -->
<!-- Fonction javascript qui affiche un bouton permettant de reculer    -->
<!-- d'une page. (Equivalent au bouton PRECEDENT ou BACK du navigateur) -->
<!-- ****************************************************************** -->
	<a href="javascript:history.back()" OnMouseOver="window.status='Retour-Back';return true;">
		<img src="/www/revues/images/back.gif" width="60" height="60" border="0" alt="page précédente / back">
		Page précédente
	</a>
</DEFMACRO>
